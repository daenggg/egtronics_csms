<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" content="">
        <meta name="author" content="">
        <meta name="generator" content="">
        <title>test page</title>

        <script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js" ></script>
        <link href="https://kendo.cdn.telerik.com/2020.3.915/styles/kendo.common.min.css" rel="stylesheet" />
        <link href="https://kendo.cdn.telerik.com/2020.3.915/styles/kendo.default.min.css" rel="stylesheet" />
        <script src="https://code.jquery.com/jquery-1.12.3.min.js"></script>
        <script src="https://kendo.cdn.telerik.com/2020.3.915/js/kendo.all.min.js"></script>
        <!-- Bootstrap core CSS -->
      <link href="../assets/dist/css/bootstrap.min.css" rel="stylesheet">
      <link href="../dashboard.css" rel="stylesheet">
      </head>
      
      <body style="background-color: rgb(255, 255, 255)">
        <header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
          <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#">Egtronics</a>
        </header>
      <!--  <form id="fileForm" action="http://192.168.0.101:8443/api/firmware/upload" method="post" enctype="multipart/form-data">
          <span class="file" id="file">
              <input type="file" id="testUploadFile" name="file" >
          </span>
        </form>
      -->

        <form id="uploadForm">
          <input type="file" name="file"/>
          <button type="button" id="uploadBtn">Save</button>
          </form>
          
         </body>
</html>

<script type="text/javascript" src="../practice.js" ></script>
<script >
$(function(){
 $('#uploadBtn').on('click', function(){
uploadFile();
});
});

function uploadFile(){
var form = $('#uploadForm')[0];
var formData = new FormData(form);
console.log(formData);
var t = sessionStorage.getItem('accessToken');
		$.ajax({
        type : 'post',
        url : reqURL+'/firmware/upload',
        data : formData,
        processData : false,
        contentType : false,
        beforeSend: function (xhr) {
            xhr.setRequestHeader("Authorization","Bearer " + t);
            xhr.setRequestHeader("menuId","1");
            xhr.setRequestHeader("permit","c");
        },
        success : function(data) {
          console.log('응답'+ JSON.stringify(data));
            //alert("파일 업로드 성공."+ JSON.stringify(data));
        },
        error : function(error) {
          alert('실패: ' + error.responseText);
           
        }
    });
}


$("#testUploadFile").change(function(){
    var formData = new FormData($("#fileForm")[0]);
    var t = sessionStorage.getItem('accessToken');
    $.ajax({
        type : 'post',
        url : reqURL+'/firmware/upload',
        data : formData,
        processData : false,
        contentType : false,
        beforeSend: function (xhr) {
            xhr.setRequestHeader("Authorization","Bearer " + t);
            xhr.setRequestHeader("menuId","1");
            xhr.setRequestHeader("permit","c");
        },
        success : function(data) {
          console.log('formData' + JSON.stringify(formData));
          console.log('응답'+ JSON.stringify(data));
            alert("파일 업로드 성공."+ JSON.stringify(data));
        },
        error : function(error) {
          alert('실패: ' + error.responseText);
           
        }
    });      
 
});    

</script>