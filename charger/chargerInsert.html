<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="generator" content="">
    <title>충전기 등록</title>

    <script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script>
    <link href="https://kendo.cdn.telerik.com/2020.3.915/styles/kendo.common.min.css" rel="stylesheet" />
    <link href="https://kendo.cdn.telerik.com/2020.3.915/styles/kendo.default.min.css" rel="stylesheet" />
    <script src="https://code.jquery.com/jquery-1.12.3.min.js"></script>
    <script src="../kendo/kendo.all.min.js"></script>
    <script src="../kendo/jszip.min.js"></script>
    <script src="../kendo/cultures/kendo.culture.ko-KR.min.js"></script>
    <!-- Bootstrap core CSS -->
    <link href="../assets/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        #input-select {
            width: 400px;
            height: 40px;
            font-size: 12px;
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }
    </style>
    <link href="../dashboard.css" rel="stylesheet">
</head>

<body style="background-color: rgb(255, 255, 255)">
    <header class="navbar navbar-dark sticky-top bg-white flex-md-nowrap p-0 shadow">
        <img src="../assets/brand/eglogo.png" class="img-fluid logo-img" alt="이지트로닉스 로고">
    </header>
    <div class="card">
        <div class="card-body">

            <div class="input-group">
                <div class="input-group-prepend">
                    <input type="text" id="stationId" class="form-control margin-right10 margin-left30" readonly="" value="충전소 ID">
                </div>
                <div class="input-group-prepend">
                    <select id="input-select" name="stationId" class="form-control input-width">
                    </select>
                </div>
            </div>
            <p></p>

            <div class="input-group">
                <div class="input-group-prepend">
                    <input type="text" id="chargerId" class="form-control margin-right10 margin-left30" readonly="" value="충전기 ID" >
                </div>
                <div class="input-group-prepend">
                    <input id="input-select" name="chargerId" type="text" class="form-control input-width" value="" placeholder=" 충전기 ID를 입력하세요" />
                </div>
            </div>
            <p></p>

            <div class="input-group">
                <div class="input-group-prepend">
                    <input type="text" id="chargerName" class="form-control margin-right10 margin-left30" readonly="" value="충전기 이름" >
                </div>
                <div class="input-group-prepend">
                    <input id="input-select" name="chargerName" type="text" class="form-control input-width" value="" placeholder="충전기 이름을 입력하세요" />
                </div>
            </div>
            <p></p>

            <div class="input-group">
                <div class="input-group-prepend">
                    <input type="text" id="chargerModelCode" class="form-control margin-right10 margin-left30" readonly="" value="충전기 모델 명" >
                </div>
                <div class="input-group-prepend">
                    <select id="input-select" name="chargerModelCode" class="form-control input-width" placeholder="충전기 모델 코드를 입력하세요." >

                    </select>
                </div>
            </div>
            <p></p>

            <div class="input-group">
                <div class="input-group-prepend">
                    <input type="text" id="chargerSerialNumber" class="form-control margin-right10 margin-left30" readonly="" value="충전기 시리얼" >
                </div>
                <div class="input-group-prepend">
                    <input id="input-select" name="chargerSerialNumber" type="text" class="form-control input-width" value="" placeholder="충전기 시리얼 번호를 입력하세요." />
                </div>
            </div>
            <p></p>

            <div class="input-group">
                <div class="input-group-prepend">
                    <input type="text" id="kecoRoamingYn" class="form-control margin-right10 margin-left30" readonly="" value="환경부 로밍 여부" >
                </div>
                <div class="custom-select-wrapper">
                    <select name="kecoRoamingYn" id="kecoRoamingYn1" class="form-control input-width custom-select">
                        <option value="answer-use1">사용</option>
                        <option value="answer-not-use1">미사용</option>
                    </select>
                </div>

            </div>
            <p></p>

            <div class="input-group">
                <div class="input-group-prepend">
                    <input type="text" id="kepcoRoamingYn" class="form-control margin-right10 margin-left30" readonly="" value="한전 로밍 여부" >
                </div>
                <div class="custom-select-wrapper">
                    <select name="kepcoRoamingYn" id="kepcoRoamingYn1" class="form-control input-width custom-select">
                        <option value="answer-use1">사용</option>
                        <option value="answer-not-use1">미사용</option>
                    </select>
                </div>

            </div>
            <p></p>

            <div class="input-group">
                <div class="input-group-prepend">
                    <input type="text" id="useYn" class="form-control margin-right10 margin-left30" readonly="" value="사용 유무" >
                </div>
                <div class="custom-select-wrapper">
                    <select name="useYn" id="useYn1" class="form-control input-width custom-select">
                        <option value="answer-use">사용</option>
                        <option value="answer-not-use">미사용</option>
                    </select>
                </div>

            </div>
            <p></p>

            <div class="input-group">
                <div class="input-group-prepend">
                    <input type="text" id="deleteYn" class="form-control margin-right10 margin-left30" readonly="" value="삭제 유무" >
                </div>
                <div class="custom-select-wrapper">
                    <select name="deleteYn" id="deleteYn1" class="form-control input-width custom-select">
                        <option value="answer-yes">예</option>
                        <option value="answer-no">아니오</option>
                    </select>
                </div>

            </div>
            <p></p>
            <p></p>


            <div class="input-group d-flex justify-content-center">
                <button class="btn btn-primary" id="insertButton" onclick="btnStationInsert()">등록</button>
                <button class="btn btn-secondary ms-2" id="cancelButton" onclick="window.close()">취소</button>
            </div>

        </div>
    </div>
</body>

</html>

<script src="../practice.js"></script>
<script>
var t = sessionStorage.getItem('accessToken');

$(document).ready(function () {
    $.ajax({    			
        url: reqURL + "/station/info/page/list?page=1&size=10000",
        type: "GET",
        dataType: "json", 
        contentType: "application/json",
        timeout: 5000, // 타임 아웃 설정
        beforeSend: function (xhr) {
            xhr.setRequestHeader("Authorization","Bearer " + t);
            xhr.setRequestHeader("menuId","10");
            xhr.setRequestHeader("permit","r");
        },
        success: function(data, textStatus, xhr) {
          var content =  data.payload.content;
          console.log(content);
          for(var i = 0; i < content.length; i ++) {
              $("select[name=stationId]").append("<option value='"+ (content[i].stationId)+"'>" + (content[i].stationName) + "</option>")
            }
              
        },
        error: function(error) {
            alert('충전소 정보 호출 실패: ' + error.responseText);
        }
      });        
})

$(document).ready(function () {
    $.ajax({    			
        url: reqURL+"/charger/model/info/page/list?page=1&size=10000",
        type: "GET",
        dataType: "json", 
        contentType: "application/json",
        timeout: 5000, // 타임 아웃 설정
        beforeSend: function (xhr) {
            xhr.setRequestHeader("Authorization","Bearer " + t);
            xhr.setRequestHeader("menuId","10");
            xhr.setRequestHeader("permit","r");
        },
        success: function(data, textStatus, xhr) {
            
           var content =  data.payload.content;
           console.log(content);
          
           for(var i = 0; i < content.length; i ++) {
              $("select[name=chargerModelCode]").append("<option value='"+ (content[i].chargerModelCode)+"'>" + (content[i].chargerModelName) + "</option>")
             }
              
        },
        error: function(error) {
            alert('충전소 정보 호출 실패: ' + error.responseText);
        }
      });        
})



function btnStationInsert() {
    var Load = {
        stationId: $("select[name=stationId]").val(),
        chargerId: $("input[name=chargerId]").val(),
        chargerName: $("input[name=chargerName]").val(),
        chargerModelCode: $("select[name=chargerModelCode]").val(),
        chargerSerialNumber: $("input[name=chargerSerialNumber]").val(),
        kecoRoamingYn: $("select[name=kecoRoamingYn]").val(), // 수정
        kepcoRoamingYn: $("select[name=kepcoRoamingYn]").val(), // 수정
        useYn: $("select[name=useYn]").val(), // 수정
        deleteYn: $("select[name=deleteYn]").val(), // 수정
    };
    //  console.log("[data] : " + JSON.stringify(Load));
    //  alert("[data] : " + JSON.stringify(PayLoad));

    $.ajax({
        url: reqURL + "/charger/info/create",
        type: "POST",
        dataType: "json",
        data: JSON.stringify(Load), //json 데이터
        contentType: "application/json",
        timeout: 5000, // 타임 아웃 설정
        beforeSend: function(xhr) {
            xhr.setRequestHeader("Authorization", "Bearer " + t);
            xhr.setRequestHeader("menuId", "13");
            xhr.setRequestHeader("permit", "r");
        },
        success: function(data, textStatus, xhr) {
            console.log("[data] : " + JSON.stringify(data));
            if (confirm('충전기가 등록되었습니다.')) {
                window.close();  // 현재 창을 닫음
                window.opener.location.reload();  // 부모 창(원본 창)을 새로고침
            }
        },
        error: function(error) {
            alert('실패: ' + error.responseText);
        }
    });

}

    
    
</script>